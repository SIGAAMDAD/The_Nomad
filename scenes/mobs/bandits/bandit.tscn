[gd_scene load_steps=19 format=3 uid="uid://dil6cvnitkb3b"]

[ext_resource type="Shader" uid="uid://bnpck43i3rc32" path="res://shaders/visor_glow_blue.gdshader" id="1_q3nyr"]
[ext_resource type="Script" uid="uid://cg547d4tqtl3s" path="res://scripts/Renown/Thinkers/Bandit.cs" id="1_sse78"]
[ext_resource type="SpriteFrames" uid="uid://dkqmricfe235j" path="res://resources/animations/mobs/bandit_grunt_head_animations.tres" id="2_q3nyr"]
[ext_resource type="Script" uid="uid://ya6g5a1ll81k" path="res://scripts/Hitbox.cs" id="3_02k6i"]
[ext_resource type="SpriteFrames" uid="uid://hvxaope63nbh" path="res://resources/animations/mobs/bandit_grunt_body_animations.tres" id="4_q3nyr"]
[ext_resource type="SpriteFrames" uid="uid://dt3nr18ulah26" path="res://resources/animations/mobs/bandit_grunt_arm_animations.tres" id="5_q3nyr"]
[ext_resource type="Script" uid="uid://d11c6gwrjou0w" path="res://addons/behaviour_toolkit/behaviour_tree/bt_root.gd" id="7_yadcl"]
[ext_resource type="Script" uid="uid://b0bqn8gtyevqu" path="res://addons/behaviour_toolkit/finite_state_machine/fsm.gd" id="8_2sbjv"]
[ext_resource type="Script" uid="uid://dpr2xa1e5hy8u" path="res://addons/behaviour_toolkit/behaviour_tree/composites/bt_sequence.gd" id="8_p2hl0"]
[ext_resource type="Script" uid="uid://c584shlo6w6it" path="res://addons/behaviour_toolkit/behaviour_tree/bt_leaf.gd" id="9_i3org"]
[ext_resource type="Script" uid="uid://csq05x4oq8uf3" path="res://addons/behaviour_toolkit/blackboard.gd" id="9_p2hl0"]
[ext_resource type="Script" uid="uid://crgq2opfxk1ng" path="res://scripts/Renown/Thinkers/Behaviours/mercenary_animator.gd" id="10_i3org"]
[ext_resource type="Script" uid="uid://1h0braq41vwb" path="res://addons/behaviour_toolkit/finite_state_machine/fsm_transition.gd" id="11_n1021"]
[ext_resource type="Script" uid="uid://dyh6qrmrhuck5" path="res://scripts/Renown/Thinkers/Behaviours/dead_animation.gd" id="12_q4sce"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_lqbnx"]
shader = ExtResource("1_q3nyr")
shader_parameter/glow_color = Color(0, 0.133333, 0.541176, 1)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sv13l"]
size = Vector2(11, 10)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_gnc44"]
size = Vector2(18, 21)

[sub_resource type="Resource" id="Resource_n8qdm"]
script = ExtResource("9_p2hl0")
content = {}
metadata/_custom_type_script = "uid://csq05x4oq8uf3"

[node name="Bandit" type="CharacterBody2D" node_paths=PackedStringArray("AnimationStateMachine", "BehaviourTree", "Relations", "Debts") groups=["Archive", "Thinkers"]]
z_index = 6
collision_layer = 12
collision_mask = 12
script = ExtResource("1_sse78")
LoseInterestTime = 10.0
SightDetectionTime = 15.0
SightDetectionSpeed = 0.75
AnimationStateMachine = NodePath("AnimationStateMachine")
BehaviourTree = NodePath("Behaviour")
MovementSpeed = 180.0
Health = 80.0
Relations = {}
Debts = {}

[node name="Animations" type="Node2D" parent="."]

[node name="HeadAnimations" type="AnimatedSprite2D" parent="Animations"]
material = SubResource("ShaderMaterial_lqbnx")
position = Vector2(0, -7)
sprite_frames = ExtResource("2_q3nyr")
animation = &"move"
autoplay = "idle"

[node name="HeadHitbox" type="Area2D" parent="Animations/HeadAnimations" node_paths=PackedStringArray("Parent")]
collision_layer = 16
collision_mask = 16
script = ExtResource("3_02k6i")
Parent = NodePath("../../..")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Animations/HeadAnimations/HeadHitbox"]
position = Vector2(0.5, -1)
shape = SubResource("RectangleShape2D_sv13l")

[node name="BodyAnimations" type="AnimatedSprite2D" parent="Animations"]
sprite_frames = ExtResource("4_q3nyr")
animation = &"die_low"
autoplay = "calm"

[node name="SmokeEmitter" type="CPUParticles2D" parent="Animations/BodyAnimations"]
position = Vector2(4, -6)
emitting = false
amount = 50
lifetime = 2.0
one_shot = true
emission_shape = 1
emission_sphere_radius = 4.0
gravity = Vector2(0, -50)
angle_min = -4.5
angle_max = 65.1

[node name="ArmAnimations" type="AnimatedSprite2D" parent="Animations"]
position = Vector2(1, -3)
sprite_frames = ExtResource("5_q3nyr")
animation = &"move"

[node name="VisibleOnScreenNotifier2D" type="VisibleOnScreenNotifier2D" parent="."]
position = Vector2(59, -10)
scale = Vector2(6.7, 4.6)
rect = Rect2(-10.8955, -2.82609, 4.92537, 9.13043)

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, 7.5)
shape = SubResource("RectangleShape2D_gnc44")

[node name="DetectionMeter" type="Line2D" parent="."]
position = Vector2(11, 0)
points = PackedVector2Array(-25, -19, 4, -19)
width = 6.0

[node name="Behaviour" type="Node" parent="."]
script = ExtResource("7_yadcl")
metadata/_custom_type_script = "uid://d11c6gwrjou0w"

[node name="Relaxed" type="Node" parent="Behaviour"]
script = ExtResource("8_p2hl0")
metadata/_custom_type_script = "uid://dpr2xa1e5hy8u"

[node name="BTLeaf" type="Node" parent="Behaviour/Relaxed"]
script = ExtResource("9_i3org")
metadata/_custom_type_script = "uid://c584shlo6w6it"

[node name="AnimationStateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state", "actor")]
script = ExtResource("8_2sbjv")
process_type = 0
initial_state = NodePath("Idle")
actor = NodePath("..")
blackboard = SubResource("Resource_n8qdm")
metadata/_custom_type_script = "uid://b0bqn8gtyevqu"

[node name="Idle" type="Node" parent="AnimationStateMachine"]
script = ExtResource("10_i3org")
_animation = &"idle"
metadata/_custom_type_script = "uid://k5p6yghm7nrm"

[node name="OnStartMoving" type="Node" parent="AnimationStateMachine/Idle" node_paths=PackedStringArray("next_state")]
script = ExtResource("11_n1021")
next_state = NodePath("../../Moving")
use_event = true
event = "start_moving"
metadata/_custom_type_script = "uid://1h0braq41vwb"

[node name="OnDeath" type="Node" parent="AnimationStateMachine/Idle" node_paths=PackedStringArray("next_state")]
script = ExtResource("11_n1021")
next_state = NodePath("../../Dead")
use_event = true
event = "die"
metadata/_custom_type_script = "uid://1h0braq41vwb"

[node name="Moving" type="Node" parent="AnimationStateMachine"]
script = ExtResource("10_i3org")
_animation = &"move"
metadata/_custom_type_script = "uid://k5p6yghm7nrm"

[node name="OnStopMoving" type="Node" parent="AnimationStateMachine/Moving" node_paths=PackedStringArray("next_state")]
script = ExtResource("11_n1021")
next_state = NodePath("../../Idle")
use_event = true
event = "stop_moving"
metadata/_custom_type_script = "uid://1h0braq41vwb"

[node name="OnDeath" type="Node" parent="AnimationStateMachine/Moving" node_paths=PackedStringArray("next_state")]
script = ExtResource("11_n1021")
next_state = NodePath("../../Dead")
use_event = true
event = "die"
metadata/_custom_type_script = "uid://1h0braq41vwb"

[node name="Dead" type="Node" parent="AnimationStateMachine"]
script = ExtResource("12_q4sce")
metadata/_custom_type_script = "uid://k5p6yghm7nrm"
